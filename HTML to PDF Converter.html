<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML to PDF Converter</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.5/purify.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4cc9f0;
            --warning: #f9c74f;
            --danger: #f94144;
            --gray: #6c757d;
            --border-radius: 8px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7ff 0%, #e5e9f7 100%);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            position: relative;
            overflow: hidden;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: var(--gray);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .divider {
            height: 4px;
            width: 60px;
            background: var(--accent);
            margin: 15px auto;
            border-radius: 2px;
        }
        
        .card {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }
        
        .card-title {
            font-size: 1.2rem;
            color: var(--secondary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: var(--accent);
        }
        
        .input-methods {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .method-tabs {
            display: flex;
            border-bottom: 2px solid #eee;
            margin-bottom: 20px;
        }
        
        .method-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
        }
        
        .method-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 600;
        }
        
        .method-content {
            display: none;
        }
        
        .method-content.active {
            display: block;
        }
        
        .code-editor {
            width: 100%;
            min-height: 300px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }
        
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: var(--border-radius);
            padding: 40px 20px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            background-color: #fafafa;
            margin-bottom: 20px;
        }
        
        .upload-area:hover, .upload-area.dragover {
            border-color: var(--primary);
            background-color: #f0f4ff;
        }
        
        .upload-icon {
            font-size: 48px;
            color: #aaa;
            margin-bottom: 15px;
            display: block;
        }
        
        .options-area {
            margin-bottom: 25px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .option-group {
            margin-bottom: 15px;
        }
        
        .option-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--secondary);
        }
        
        .option-select, .option-input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
            background-color: white;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }
        
        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .preview-area {
            display: none;
            margin-bottom: 25px;
        }
        
        .preview-title {
            text-align: center;
            margin-bottom: 15px;
            color: var(--secondary);
            font-size: 1.3rem;
        }
        
        .preview-container {
            border: 1px solid #eee;
            border-radius: var(--border-radius);
            padding: 20px;
            background: white;
            min-height: 200px;
            max-height: 400px;
            overflow: auto;
        }
        
        .progress-area {
            display: none;
            margin-bottom: 25px;
        }
        
        .progress-bar {
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .status-text {
            text-align: center;
            color: var(--gray);
            font-size: 14px;
        }
        
        .info-area {
            background: #e9f7ff;
            border-left: 4px solid var(--success);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 20px;
        }
        
        .info-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--secondary);
        }
        
        .info-text {
            font-size: 14px;
            color: var(--gray);
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: var(--gray);
            font-size: 14px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .input-methods {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 250px;
                justify-content: center;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .options-area {
                grid-template-columns: 1fr;
            }
        }
        
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            display: inline-block;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        .limitations {
            background: #fff4e6;
            border-left: 4px solid var(--warning);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 20px;
        }
        
        .limitations-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--warning);
        }
        
        .limitations-text {
            font-size: 14px;
            color: var(--gray);
        }
        
        .html-preview {
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            padding: 15px;
            background: white;
            min-height: 200px;
            max-height: 400px;
            overflow: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>HTML to PDF Converter</h1>
            <div class="divider"></div>
            <p class="subtitle">Convert HTML code or files to PDF format using open-source libraries</p>
        </header>
        
        <div class="card">
            <div class="card-title">
                <i>📄</i>
                <span>Input your HTML</span>
            </div>
            
            <div class="method-tabs">
                <div class="method-tab active" data-method="code">HTML Code</div>
                <div class="method-tab" data-method="file">HTML File</div>
            </div>
            
            <div class="method-content active" id="codeMethod">
                <textarea class="code-editor" id="htmlCode" placeholder="Paste your HTML code here..."><!DOCTYPE html>
<html>
<head>
    <title>Sample HTML</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        h1 { color: #3366cc; }
        p { line-height: 1.6; }
    </style>
</head>
<body>
    <h1>Welcome to HTML to PDF Converter</h1>
    <p>This is a sample HTML content that will be converted to PDF.</p>
    <p>You can edit this code or paste your own HTML to convert it.</p>
    <ul>
        <li>Feature 1: Convert HTML code to PDF</li>
        <li>Feature 2: Upload HTML files</li>
        <li>Feature 3: Customize PDF output</li>
    </ul>
</body>
</html></textarea>
            </div>
            
            <div class="method-content" id="fileMethod">
                <div class="upload-area" id="uploadArea">
                    <span class="upload-icon">📁</span>
                    <p>Drag & drop your HTML file here or <span style="color: var(--primary); text-decoration: underline;">browse files</span></p>
                    <input type="file" id="fileInput" accept=".html,.htm" style="display: none;">
                </div>
                <div id="fileName" style="text-align: center; margin-top: 10px; font-style: italic;"></div>
            </div>
            
            <div class="card-title" style="margin-top: 25px;">
                <i>⚙️</i>
                <span>Conversion Options</span>
            </div>
            
            <div class="options-area">
                <div class="option-group">
                    <label class="option-label" for="pageSize">Page Size</label>
                    <select class="option-select" id="pageSize">
                        <option value="a4">A4</option>
                        <option value="letter">Letter</option>
                        <option value="legal">Legal</option>
                    </select>
                </div>
                
                <div class="option-group">
                    <label class="option-label" for="orientation">Orientation</label>
                    <select class="option-select" id="orientation">
                        <option value="portrait">Portrait</option>
                        <option value="landscape">Landscape</option>
                    </select>
                </div>
                
                <div class="option-group">
                    <label class="option-label" for="margin">Margin (mm)</label>
                    <input type="number" class="option-input" id="margin" value="10" min="0" max="50">
                </div>
                
                <div class="option-group">
                    <label class="option-label" for="quality">Quality</label>
                    <select class="option-select" id="quality">
                        <option value="high">High</option>
                        <option value="medium" selected>Medium</option>
                        <option value="low">Low</option>
                    </select>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" id="convertBtn">
                    <span>Convert to PDF</span>
                </button>
                <button class="btn btn-success" id="downloadBtn" disabled>
                    <span>Download PDF</span>
                </button>
            </div>
        </div>
        
        <div class="preview-area" id="previewArea">
            <h3 class="preview-title">HTML Preview</h3>
            <div class="html-preview" id="htmlPreview">
                <!-- HTML preview will be rendered here -->
            </div>
        </div>
        
        <div class="progress-area" id="progressArea">
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
            <p class="status-text" id="statusText">Processing...</p>
        </div>
        
        <div class="limitations">
            <p class="limitations-title">Limitations</p>
            <p class="limitations-text">
                This converter works best with simple HTML and CSS. Complex layouts, external fonts, and certain CSS properties may not render perfectly in the PDF. 
                For best results with complex HTML, consider using server-side conversion tools.
            </p>
        </div>
        
        <div class="info-area">
            <p class="info-title">About this converter</p>
            <p class="info-text">This tool uses open-source libraries (jsPDF) to convert HTML to PDF directly in your browser. Your HTML is not uploaded to any server - conversion happens locally on your device.</p>
        </div>
        
        <footer>
            <p>Powered by open-source technology • jsPDF, DOMPurify, FileSaver.js</p>
            <p>© 2023 HTML to PDF Converter. All rights reserved.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize jsPDF
            const { jsPDF } = window.jspdf;
            
            const methodTabs = document.querySelectorAll('.method-tab');
            const methodContents = document.querySelectorAll('.method-content');
            const htmlCode = document.getElementById('htmlCode');
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const fileName = document.getElementById('fileName');
            const convertBtn = document.getElementById('convertBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const progressArea = document.getElementById('progressArea');
            const progressBar = document.getElementById('progressBar');
            const statusText = document.getElementById('statusText');
            const previewArea = document.getElementById('previewArea');
            const htmlPreview = document.getElementById('htmlPreview');
            const pageSizeSelect = document.getElementById('pageSize');
            const orientationSelect = document.getElementById('orientation');
            const marginInput = document.getElementById('margin');
            const qualitySelect = document.getElementById('quality');
            
            let currentFileContent = '';
            let pdfData = null;
            
            // Method tabs functionality
            methodTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const method = this.getAttribute('data-method');
                    
                    // Update active tab
                    methodTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show active content
                    methodContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === method + 'Method') {
                            content.classList.add('active');
                        }
                    });
                });
            });
            
            // File upload handling
            uploadArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', function(e) {
                if (this.files && this.files.length > 0) {
                    handleFile(this.files[0]);
                }
            });
            
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', function() {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
                    handleFile(e.dataTransfer.files[0]);
                }
            });
            
            function handleFile(file) {
                // Check if file is an HTML document
                if (!file.name.match(/\.(html|htm)$/i)) {
                    alert('Please select an HTML file (.html or .htm).');
                    return;
                }
                
                // Update UI
                fileName.textContent = `Selected file: ${file.name}`;
                
                // Read the file
                const reader = new FileReader();
                reader.onload = function(event) {
                    currentFileContent = event.target.result;
                    
                    // Update code editor too
                    htmlCode.value = currentFileContent;
                    
                    // Render preview
                    renderPreview(currentFileContent);
                };
                
                reader.readAsText(file);
            }
            
            // Render HTML preview
            function renderPreview(html) {
                // Sanitize HTML first
                const cleanHTML = DOMPurify.sanitize(html);
                
                // Update preview
                htmlPreview.innerHTML = cleanHTML;
                previewArea.style.display = 'block';
            }
            
            // Auto-update preview when code changes
            htmlCode.addEventListener('input', function() {
                currentFileContent = this.value;
                renderPreview(currentFileContent);
            });
            
            // Initial preview render
            renderPreview(htmlCode.value);
            
            // Conversion process
            convertBtn.addEventListener('click', function() {
                const htmlContent = htmlCode.value;
                
                if (!htmlContent.trim()) {
                    alert('Please enter some HTML code to convert.');
                    return;
                }
                
                // Show progress
                progressArea.style.display = 'block';
                progressBar.style.width = '0%';
                statusText.textContent = 'Converting...';
                downloadBtn.disabled = true;
                
                // Get options
                const pageSize = pageSizeSelect.value;
                const orientation = orientationSelect.value;
                const margin = parseInt(marginInput.value);
                const quality = qualitySelect.value;
                
                // Use setTimeout to allow UI to update
                setTimeout(() => {
                    try {
                        progressBar.style.width = '30%';
                        statusText.textContent = 'Processing HTML...';
                        
                        // Sanitize HTML
                        const cleanHTML = DOMPurify.sanitize(htmlContent);
                        
                        progressBar.style.width = '60%';
                        statusText.textContent = 'Generating PDF...';
                        
                        // Create PDF
                        const pdf = new jsPDF({
                            orientation: orientation,
                            unit: 'mm',
                            format: pageSize
                        });
                        
                        // Set margins
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        const pdfHeight = pdf.internal.pageSize.getHeight();
                        
                        // Add HTML content
                        pdf.html(cleanHTML, {
                            x: margin,
                            y: margin,
                            html2canvas: {
                                scale: quality === 'high' ? 1.5 : quality === 'medium' ? 1 : 0.5
                            },
                            callback: function(pdf) {
                                progressBar.style.width = '90%';
                                statusText.textContent = 'Finalizing PDF...';
                                
                                // Generate PDF data
                                pdfData = pdf.output('blob');
                                
                                // Complete progress
                                progressBar.style.width = '100%';
                                statusText.textContent = 'Conversion complete!';
                                
                                // Enable download button
                                downloadBtn.disabled = false;
                            }
                        });
                    } catch (error) {
                        console.error('Error creating PDF:', error);
                        statusText.textContent = 'Error creating PDF. Please try again.';
                    }
                }, 100);
            });
            
            // Download functionality
            downloadBtn.addEventListener('click', function() {
                if (!pdfData) return;
                
                // Create file name
                const fileName = 'converted-document.pdf';
                
                // Download the PDF
                saveAs(pdfData, fileName);
            });
        });
    </script>
</body>
</html>