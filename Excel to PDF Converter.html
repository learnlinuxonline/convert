<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel to PDF Converter</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4cc9f0;
            --warning: #f9c74f;
            --danger: #f94144;
            --gray: #6c757d;
            --border-radius: 8px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7ff 0%, #e5e9f7 100%);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            position: relative;
            overflow: hidden;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: var(--gray);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .divider {
            height: 4px;
            width: 60px;
            background: var(--accent);
            margin: 15px auto;
            border-radius: 2px;
        }
        
        .card {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }
        
        .card-title {
            font-size: 1.2rem;
            color: var(--secondary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: var(--accent);
        }
        
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: var(--border-radius);
            padding: 40px 20px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            background-color: #fafafa;
            margin-bottom: 20px;
        }
        
        .upload-area:hover, .upload-area.dragover {
            border-color: var(--primary);
            background-color: #f0f4ff;
        }
        
        .upload-icon {
            font-size: 48px;
            color: #aaa;
            margin-bottom: 15px;
            display: block;
        }
        
        .options-area {
            margin-bottom: 25px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .option-group {
            margin-bottom: 15px;
        }
        
        .option-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--secondary);
        }
        
        .option-select, .option-input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
            background-color: white;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }
        
        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .preview-area {
            display: none;
            margin-bottom: 25px;
        }
        
        .preview-title {
            text-align: center;
            margin-bottom: 15px;
            color: var(--secondary);
            font-size: 1.3rem;
        }
        
        .sheet-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
        }
        
        .sheet-tab {
            padding: 8px 16px;
            background: #e9ecef;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .sheet-tab.active {
            background: var(--primary);
            color: white;
        }
        
        .preview-container {
            border: 1px solid #eee;
            border-radius: var(--border-radius);
            padding: 20px;
            background: white;
            overflow: auto;
            max-height: 400px;
        }
        
        .excel-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .excel-table th, .excel-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        .excel-table th {
            background-color: #f2f2f2;
            font-weight: 600;
        }
        
        .excel-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .progress-area {
            display: none;
            margin-bottom: 25px;
        }
        
        .progress-bar {
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .status-text {
            text-align: center;
            color: var(--gray);
            font-size: 14px;
        }
        
        .info-area {
            background: #e9f7ff;
            border-left: 4px solid var(--success);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 20px;
        }
        
        .info-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--secondary);
        }
        
        .info-text {
            font-size: 14px;
            color: var(--gray);
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: var(--gray);
            font-size: 14px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 250px;
                justify-content: center;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .options-area {
                grid-template-columns: 1fr;
            }
        }
        
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            display: inline-block;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        .limitations {
            background: #fff4e6;
            border-left: 4px solid var(--warning);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 20px;
        }
        
        .limitations-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--warning);
        }
        
        .limitations-text {
            font-size: 14px;
            color: var(--gray);
        }
        
        .file-info {
            text-align: center;
            margin-top: 10px;
            font-style: italic;
            color: var(--gray);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Excel to PDF Converter</h1>
            <div class="divider"></div>
            <p class="subtitle">Convert Excel spreadsheets to PDF format using open-source libraries</p>
        </header>
        
        <div class="card">
            <div class="card-title">
                <i>📊</i>
                <span>Upload your Excel file</span>
            </div>
            
            <div class="upload-area" id="uploadArea">
                <span class="upload-icon">📁</span>
                <p>Drag & drop your Excel file here or <span style="color: var(--primary); text-decoration: underline;">browse files</span></p>
                <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
            </div>
            <div class="file-info" id="fileInfo"></div>
            
            <div class="card-title">
                <i>⚙️</i>
                <span>Conversion Options</span>
            </div>
            
            <div class="options-area">
                <div class="option-group">
                    <label class="option-label" for="pageSize">Page Size</label>
                    <select class="option-select" id="pageSize">
                        <option value="a4">A4</option>
                        <option value="letter">Letter</option>
                        <option value="legal">Legal</option>
                    </select>
                </div>
                
                <div class="option-group">
                    <label class="option-label" for="orientation">Orientation</label>
                    <select class="option-select" id="orientation">
                        <option value="portrait">Portrait</option>
                        <option value="landscape">Landscape</option>
                    </select>
                </div>
                
                <div class="option-group">
                    <label class="option-label" for="margin">Margin (mm)</label>
                    <input type="number" class="option-input" id="margin" value="10" min="0" max="50">
                </div>
                
                <div class="option-group">
                    <label class="option-label" for="fontSize">Font Size</label>
                    <select class="option-select" id="fontSize">
                        <option value="8">8pt</option>
                        <option value="10" selected>10pt</option>
                        <option value="12">12pt</option>
                        <option value="14">14pt</option>
                    </select>
                </div>
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="showGrid" checked>
                <label for="showGrid">Show grid lines in PDF</label>
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="repeatHeader" checked>
                <label for="repeatHeader">Repeat header on each page</label>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" id="convertBtn" disabled>
                    <span>Convert to PDF</span>
                </button>
                <button class="btn btn-success" id="downloadBtn" disabled>
                    <span>Download PDF</span>
                </button>
            </div>
        </div>
        
        <div class="preview-area" id="previewArea">
            <h3 class="preview-title">Excel Preview</h3>
            <div class="sheet-tabs" id="sheetTabs">
                <!-- Sheet tabs will be added here -->
            </div>
            <div class="preview-container" id="previewContainer">
                <!-- Excel preview will be rendered here -->
            </div>
        </div>
        
        <div class="progress-area" id="progressArea">
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
            <p class="status-text" id="statusText">Processing...</p>
        </div>
        
        <div class="limitations">
            <p class="limitations-title">Limitations</p>
            <p class="limitations-text">
                This converter works best with simple Excel files. Complex formatting, formulas, charts, and images may not convert perfectly. 
                For best results with complex spreadsheets, consider using Microsoft Excel or specialized conversion tools.
            </p>
        </div>
        
        <div class="info-area">
            <p class="info-title">About this converter</p>
            <p class="info-text">This tool uses open-source libraries (SheetJS, jsPDF, AutoTable) to convert Excel files to PDF directly in your browser. Your files are not uploaded to any server - conversion happens locally on your device.</p>
        </div>
        
        <footer>
            <p>Powered by open-source technology • SheetJS, jsPDF, jsPDF-AutoTable</p>
            <p>© 2023 Excel to PDF Converter. All rights reserved.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize jsPDF
            const { jsPDF } = window.jspdf;
            
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const fileInfo = document.getElementById('fileInfo');
            const convertBtn = document.getElementById('convertBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const progressArea = document.getElementById('progressArea');
            const progressBar = document.getElementById('progressBar');
            const statusText = document.getElementById('statusText');
            const previewArea = document.getElementById('previewArea');
            const sheetTabs = document.getElementById('sheetTabs');
            const previewContainer = document.getElementById('previewContainer');
            const pageSizeSelect = document.getElementById('pageSize');
            const orientationSelect = document.getElementById('orientation');
            const marginInput = document.getElementById('margin');
            const fontSizeSelect = document.getElementById('fontSize');
            const showGrid = document.getElementById('showGrid');
            const repeatHeader = document.getElementById('repeatHeader');
            
            let workbook = null;
            let currentSheet = null;
            let pdfData = null;
            
            // File upload handling
            uploadArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', function(e) {
                if (this.files && this.files.length > 0) {
                    handleFile(this.files[0]);
                }
            });
            
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', function() {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
                    handleFile(e.dataTransfer.files[0]);
                }
            });
            
            function handleFile(file) {
                // Check if file is an Excel document
                if (!file.name.match(/\.(xlsx|xls|csv)$/i)) {
                    alert('Please select an Excel file (.xlsx, .xls, or .csv).');
                    return;
                }
                
                // Update UI
                fileInfo.textContent = `File: ${file.name} (${formatFileSize(file.size)})`;
                
                // Read the file
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        progressArea.style.display = 'block';
                        progressBar.style.width = '30%';
                        statusText.textContent = 'Reading Excel file...';
                        
                        const data = new Uint8Array(event.target.result);
                        
                        // Parse Excel data
                        workbook = XLSX.read(data, { type: 'array' });
                        
                        progressBar.style.width = '60%';
                        statusText.textContent = 'Processing sheets...';
                        
                        // Display sheet tabs
                        displaySheetTabs(workbook);
                        
                        // Show first sheet by default
                        if (workbook.SheetNames.length > 0) {
                            showSheet(workbook.SheetNames[0]);
                        }
                        
                        // Enable convert button
                        convertBtn.disabled = false;
                        
                        progressBar.style.width = '100%';
                        statusText.textContent = 'File loaded successfully!';
                        
                        // Hide progress after a delay
                        setTimeout(() => {
                            progressArea.style.display = 'none';
                        }, 1000);
                        
                    } catch (error) {
                        console.error('Error reading Excel file:', error);
                        statusText.textContent = 'Error reading Excel file. Please try another file.';
                    }
                };
                
                reader.readAsArrayBuffer(file);
            }
            
            function formatFileSize(bytes) {
                if (bytes < 1024) return bytes + ' bytes';
                else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
                else return (bytes / 1048576).toFixed(1) + ' MB';
            }
            
            function displaySheetTabs(workbook) {
                sheetTabs.innerHTML = '';
                
                workbook.SheetNames.forEach((sheetName, index) => {
                    const tab = document.createElement('div');
                    tab.className = 'sheet-tab' + (index === 0 ? ' active' : '');
                    tab.textContent = sheetName;
                    tab.setAttribute('data-sheet', sheetName);
                    
                    tab.addEventListener('click', function() {
                        document.querySelectorAll('.sheet-tab').forEach(t => t.classList.remove('active'));
                        this.classList.add('active');
                        showSheet(this.getAttribute('data-sheet'));
                    });
                    
                    sheetTabs.appendChild(tab);
                });
                
                previewArea.style.display = 'block';
            }
            
            function showSheet(sheetName) {
                currentSheet = sheetName;
                const worksheet = workbook.Sheets[sheetName];
                
                // Convert to HTML table for preview
                const html = XLSX.utils.sheet_to_html(worksheet, { id: 'excel-table' });
                previewContainer.innerHTML = html;
                
                // Add Excel table class to the generated table
                const table = document.getElementById('excel-table');
                if (table) {
                    table.className = 'excel-table';
                }
            }
            
            // Conversion process
            convertBtn.addEventListener('click', function() {
                if (!workbook) return;
                
                // Show progress
                progressArea.style.display = 'block';
                progressBar.style.width = '0%';
                statusText.textContent = 'Converting to PDF...';
                downloadBtn.disabled = true;
                
                // Get options
                const pageSize = pageSizeSelect.value;
                const orientation = orientationSelect.value;
                const margin = parseInt(marginInput.value);
                const fontSize = parseInt(fontSizeSelect.value);
                const showGridLines = showGrid.checked;
                const repeatHeaderRow = repeatHeader.checked;
                
                // Use setTimeout to allow UI to update
                setTimeout(() => {
                    try {
                        progressBar.style.width = '30%';
                        statusText.textContent = 'Processing data...';
                        
                        // Create PDF
                        const pdf = new jsPDF({
                            orientation: orientation,
                            unit: 'mm',
                            format: pageSize
                        });
                        
                        // Set default font size
                        pdf.setFontSize(fontSize);
                        
                        // Process each sheet
                        const sheetCount = workbook.SheetNames.length;
                        
                        workbook.SheetNames.forEach((sheetName, index) => {
                            progressBar.style.width = `${30 + (index / sheetCount) * 60}%`;
                            statusText.textContent = `Converting sheet ${index + 1} of ${sheetCount}...`;
                            
                            const worksheet = workbook.Sheets[sheetName];
                            
                            // Convert sheet to JSON
                            const data = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                            
                            if (data.length > 0) {
                                // Add a new page for each sheet (except the first one)
                                if (index > 0) {
                                    pdf.addPage();
                                }
                                
                                // Add sheet name as title
                                pdf.setFontSize(fontSize + 4);
                                pdf.text(sheetName, margin, margin);
                                pdf.setFontSize(fontSize);
                                
                                // Create table
                                pdf.autoTable({
                                    startY: margin + 10,
                                    head: data.length > 0 ? [data[0]] : [],
                                    body: data.length > 1 ? data.slice(1) : [],
                                    theme: showGridLines ? 'grid' : 'striped',
                                    headStyles: {
                                        fillColor: [67, 97, 238], // Primary color
                                        textColor: 255,
                                        fontStyle: 'bold'
                                    },
                                    styles: {
                                        fontSize: fontSize,
                                        cellPadding: 3
                                    },
                                    margin: { top: margin + 10 },
                                    pageBreak: 'auto',
                                    rowPageBreak: 'auto',
                                    showHead: repeatHeaderRow ? 'firstPage' : 'everyPage'
                                });
                            }
                        });
                        
                        progressBar.style.width = '95%';
                        statusText.textContent = 'Finalizing PDF...';
                        
                        // Generate PDF data
                        pdfData = pdf.output('blob');
                        
                        // Complete progress
                        progressBar.style.width = '100%';
                        statusText.textContent = 'Conversion complete!';
                        
                        // Enable download button
                        downloadBtn.disabled = false;
                        
                    } catch (error) {
                        console.error('Error creating PDF:', error);
                        statusText.textContent = 'Error creating PDF. Please try again.';
                    }
                }, 100);
            });
            
            // Download functionality
            downloadBtn.addEventListener('click', function() {
                if (!pdfData) return;
                
                // Create file name
                const fileName = 'converted-spreadsheet.pdf';
                
                // Download the PDF
                saveAs(pdfData, fileName);
            });
        });
    </script>
</body>
</html>